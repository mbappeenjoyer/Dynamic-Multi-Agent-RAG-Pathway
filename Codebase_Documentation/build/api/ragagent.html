<!doctype html>
<html class="no-js" lang="en" data-content_root="../">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="../genindex.html" /><link rel="search" title="Search" href="../search.html" /><link rel="next" title="Autoprompt" href="autoprompt.html" /><link rel="prev" title="Utility Query Generator" href="utilityquerygenerator.html" />

    <!-- Generated with Sphinx 8.1.3 and Furo 2024.08.06 -->
        <title>RAG Agent - Pathway</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo.css?v=354aac6f" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo-extensions.css?v=302659d7" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  --color-brand-primary: #1617ED;
  --color-brand-content: #1617ED;
  --color-api-name: #0000FF;
  --color-api-pre-name: #0000FF;
  --color-api-keyword: #0044CC;
  --font-stack--headings: Bebas Neue, sans-serif;
  --pygments_style: livinglogic-light;
  --color-link: #0000FF;
  --color-link-hover: #0000FF;
  --color-link--visited: #1617ED;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  --color-brand-primary: #1617ED;
  --color-brand-content: #1617ED;
  --color-api-name: #0099FF;
  --color-api-pre-name: #0099FF;
  --color-api-keyword: #66CCFF;
  --font-stack--headings: Bebas Neue, sans-serif;
  --pygments_style: livinglogic-light;
  --color-link--visited: 1617ED;
  --color-link: #0000FF;
  --color-link-hover: #0000FF;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  --color-brand-primary: #1617ED;
  --color-brand-content: #1617ED;
  --color-api-name: #0099FF;
  --color-api-pre-name: #0099FF;
  --color-api-keyword: #66CCFF;
  --font-stack--headings: Bebas Neue, sans-serif;
  --pygments_style: livinglogic-light;
  --color-link--visited: 1617ED;
  --color-link: #0000FF;
  --color-link-hover: #0000FF;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../index.html"><div class="brand">Pathway</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../index.html">
  
  
  <span class="sidebar-brand-text">Pathway</span>
  
</a><form class="sidebar-search-container" method="get" action="../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">Content</span></p>
<ul class="current">
<li class="toctree-l1 has-children"><a class="reference internal" href="pathway_integration.html">Pathway Integration</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of Pathway Integration</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="pathway/groqchat.html">GroqChat Class</a></li>
<li class="toctree-l2"><a class="reference internal" href="pathway/jinaembedding.html">JinaEmbedder Class</a></li>
<li class="toctree-l2"><a class="reference internal" href="pathway/InterleavedRAGQuestionAnswerer.html">Interleaved RAG Question Answerer</a></li>
<li class="toctree-l2"><a class="reference internal" href="pathway/CodeAndReasoningAgent.html">Code and Reasoning Agent</a></li>
<li class="toctree-l2"><a class="reference internal" href="pathway/RaptorRetriever.html">RaptorRetriever Class</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="retriever.html">Retriever</a></li>
<li class="toctree-l1"><a class="reference internal" href="summary_module.html">Summary Module</a></li>
<li class="toctree-l1"><a class="reference internal" href="dynamiccacheindex.html">Dynamic Cache Index</a></li>
<li class="toctree-l1"><a class="reference internal" href="utilityquerygenerator.html">Utility Query Generator</a></li>
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">RAG Agent</a></li>
<li class="toctree-l1"><a class="reference internal" href="autoprompt.html">Autoprompt</a></li>
<li class="toctree-l1"><a class="reference internal" href="supervisor.html">Supervisor Agent</a></li>
<li class="toctree-l1"><a class="reference internal" href="default_tools.html">Default Tools</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="../_sources/api/ragagent.rst.txt" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div>
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section id="rag-agent">
<h1>RAG Agent<a class="headerlink" href="#rag-agent" title="Link to this heading">¶</a></h1>
<section id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Link to this heading">¶</a></h2>
<p>The RAGAGENT class is designed to process complex queries using a Retrieval-Augmented Generation (RAG) system, integrating thought generation, reasoning, and retrieval with memory management to generate precise, context-aware responses.</p>
</section>
<section id="initialization">
<h2>Initialization<a class="headerlink" href="#initialization" title="Link to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="RAGAGENT">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">RAGAGENT</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">llm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">embedding_dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1024</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thought_agent_prompt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reasoning_agent_prompt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">retrieval_agent_prompt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">utility_query_template</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_steps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">15</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">similarity_threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">retriever</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#RAGAGENT" title="Link to this definition">¶</a></dt>
<dd><p>Initialize the RAG agent with comprehensive configuration options.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>llm</strong> (<em>object</em>) – The language model used for query generation and processing.</p></li>
<li><p><strong>embedding_dim</strong> (<em>int</em>) – Dimension of embedding vectors. Default is 1024.</p></li>
<li><p><strong>thought_agent_prompt</strong> (<em>str</em><em>, </em><em>optional</em>) – Prompt for thought generation phase.</p></li>
<li><p><strong>reasoning_agent_prompt</strong> (<em>str</em><em>, </em><em>optional</em>) – Prompt for reasoning phase.</p></li>
<li><p><strong>retrieval_agent_prompt</strong> (<em>str</em><em>, </em><em>optional</em>) – Prompt for retrieval phase.</p></li>
<li><p><strong>utility_query_template</strong> (<em>str</em><em>, </em><em>optional</em>) – Template for generating utility queries.</p></li>
<li><p><strong>max_steps</strong> (<em>int</em>) – Maximum processing steps for a query. Default is 15.</p></li>
<li><p><strong>similarity_threshold</strong> (<em>float</em>) – Threshold for memory similarity. Default is 0.8.</p></li>
<li><p><strong>retriever</strong> (<em>object</em><em>, </em><em>optional</em>) – Raptor Retriever instance.</p></li>
<li><p><strong>path</strong> (<em>str</em><em>, </em><em>optional</em>) – path to the PDF file.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="methods">
<h2>Methods<a class="headerlink" href="#methods" title="Link to this heading">¶</a></h2>
<dl class="py method">
<dt class="sig sig-object py" id="check_memory_and_retrieve">
<span class="sig-name descname"><span class="pre">check_memory_and_retrieve</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">query</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#check_memory_and_retrieve" title="Link to this definition">¶</a></dt>
<dd><p>Checks if a query exists in memory and retrieves the best match based on similarity.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>query</strong> (<em>str</em>) – The query string to search in memory.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The best matching chunk from memory, or <cite>None</cite> if no match is found.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str or None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="check_memory_and_retrieve_for_supervisor">
<span class="sig-name descname"><span class="pre">check_memory_and_retrieve_for_supervisor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">query</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#check_memory_and_retrieve_for_supervisor" title="Link to this definition">¶</a></dt>
<dd><p>Retrieves the best match for a query from memory for supervisory tasks.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>query</strong> (<em>str</em>) – The query string to search in memory.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The best matching chunk, or <cite>None</cite> if no match is found.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str or None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="add_to_memory">
<span class="sig-name descname"><span class="pre">add_to_memory</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">query</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chunk</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">query_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'original'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">original_query</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metadata</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#add_to_memory" title="Link to this definition">¶</a></dt>
<dd><p>Adds a query and its associated chunk to memory with metadata.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>query</strong> (<em>str</em>) – The query string.</p></li>
<li><p><strong>chunk</strong> (<em>str</em>) – The chunk of data to store.</p></li>
<li><p><strong>query_type</strong> (<em>str</em>) – The type of query (e.g., ‘original’, ‘retrieval’). Default is ‘original’.</p></li>
<li><p><strong>original_query</strong> (<em>str</em>) – The original query string (optional).</p></li>
<li><p><strong>metadata</strong> (<em>dict</em>) – Additional metadata to associate with the chunk (optional).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><cite>True</cite> if the chunk was successfully added, <cite>False</cite> otherwise.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="get_existing_graph_queries">
<span class="sig-name descname"><span class="pre">get_existing_graph_queries</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#get_existing_graph_queries" title="Link to this definition">¶</a></dt>
<dd><p>Retrieves all existing graph queries from the memory cache.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A list of query strings stored in memory.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="generate_utility_queries">
<span class="sig-name descname"><span class="pre">generate_utility_queries</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">chunk</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_queries</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">existing_graph_queries</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#generate_utility_queries" title="Link to this definition">¶</a></dt>
<dd><p>Generates utility queries for a given data chunk.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>chunk</strong> (<em>str</em>) – The data chunk for generating queries.</p></li>
<li><p><strong>max_queries</strong> (<em>int</em>) – Maximum number of queries to generate.</p></li>
<li><p><strong>existing_graph_queries</strong> (<em>list</em>) – List of existing graph queries to avoid duplicates.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Generated utility queries.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="get_embedding">
<span class="sig-name descname"><span class="pre">get_embedding</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">text</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#get_embedding" title="Link to this definition">¶</a></dt>
<dd><p>Generates an embedding vector for a given text.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>text</strong> (<em>str</em>) – The input text for which to generate an embedding.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The generated embedding vector, or <cite>None</cite> if an error occurs.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray or None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="print_memory_metadata">
<span class="sig-name descname"><span class="pre">print_memory_metadata</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#print_memory_metadata" title="Link to this definition">¶</a></dt>
<dd><p>Prints metadata for all chunks in the memory cache.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="check_query_in_memory">
<span class="sig-name descname"><span class="pre">check_query_in_memory</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">query</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.9</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#check_query_in_memory" title="Link to this definition">¶</a></dt>
<dd><p>Checks if a query exists in memory using similarity scores.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>query</strong> (<em>str</em>) – The query to check.</p></li>
<li><p><strong>threshold</strong> (<em>float</em>) – Similarity threshold. Default is 0.9.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><cite>True</cite> if a similar query exists, <cite>False</cite> otherwise.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="run">
<span class="sig-name descname"><span class="pre">run</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">retriever</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">question</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#run" title="Link to this definition">¶</a></dt>
<dd><p>Execute the agent to process a query and generate a response.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>retriever</strong> (<em>object</em>) – The retrieval engine.</p></li>
<li><p><strong>question</strong> (<em>str</em>) – The query to process.</p></li>
<li><p><strong>reset</strong> (<em>bool</em>) – Whether to reset the agent’s state before running.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The final answer generated by the agent, or None if processing fails.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str or None</p>
</dd>
</dl>
</dd></dl>

<p>Recommended Usage:</p>
<blockquote>
<div><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">agent</span> <span class="o">=</span> <span class="n">RAGAGENT</span><span class="p">(</span><span class="n">llm</span><span class="p">)</span>
<span class="n">answer</span> <span class="o">=</span> <span class="n">agent</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">retriever</span><span class="p">,</span> <span class="s2">&quot;What is the capital of France?&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div></blockquote>
<dl class="py method">
<dt class="sig sig-object py" id="step">
<span class="sig-name descname"><span class="pre">step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#step" title="Link to this definition">¶</a></dt>
<dd><p>Performs a single step in the agent’s workflow, which includes thought generation, retrieval, and memory updates.</p>
<dl class="simple">
<dt><strong>Description</strong>:</dt><dd><p>This method manages the core loop of the agent’s query processing, iterating through the different stages like thought generation, retrieval, and reasoning. It triggers retrieval if the agent needs to fetch additional information, processes memory, and updates the agent’s input based on retrieved or reasoned information.</p>
</dd>
<dt><strong>Details</strong>:</dt><dd><ul class="simple">
<li><p><strong>Thought Generation</strong>: The agent generates thoughts about the current state.</p></li>
<li><p><strong>Retrieval</strong>: Based on the generated thought, the agent queries the retrieval system for relevant chunks.</p></li>
<li><p><strong>Memory</strong>: Updates the agent’s memory with newly retrieved or reasoned data.</p></li>
<li><p><strong>Utility Queries</strong>: If additional context or follow-up information is needed, utility queries are generated.</p></li>
<li><p><strong>Reasoning</strong>: If retrieval isn’t sufficient, the agent will initiate reasoning to generate a response.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="jargon_check">
<span class="sig-name descname"><span class="pre">jargon_check</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">query</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#jargon_check" title="Link to this definition">¶</a></dt>
<dd><p>Identifies jargon terms in the user’s query.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>query</strong> (<em>str</em>) – The query to be analyzed for jargon.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A list of identified jargon terms, or “None” if no jargon is found.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="rephrase">
<span class="sig-name descname"><span class="pre">rephrase</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">query</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">jargons</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#rephrase" title="Link to this definition">¶</a></dt>
<dd><p>Rephrases the user’s query by defining and explaining identified jargon terms.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>query</strong> (<em>str</em>) – The original query, potentially containing jargon.</p></li>
<li><p><strong>jargons</strong> (<em>str</em>) – A list or string of identified jargon terms that need clarification.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The rephrased query with clear definitions of jargon terms.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="prompt_thought_agent">
<span class="sig-name descname"><span class="pre">prompt_thought_agent</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#prompt_thought_agent" title="Link to this definition">¶</a></dt>
<dd><p>Generates the thought process for the agent using the thought agent prompt.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The generated thought response from the thought agent.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="prompt_reasoning_agent">
<span class="sig-name descname"><span class="pre">prompt_reasoning_agent</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">force_completion</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#prompt_reasoning_agent" title="Link to this definition">¶</a></dt>
<dd><p>Generates reasoning for the agent using the reasoning agent prompt.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>force_completion</strong> (<em>bool</em>) – If <cite>True</cite>, overrides constraints to ensure a response is generated. Default is <cite>False</cite>.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The generated reasoning response from the reasoning agent.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="parse_llm_response">
<span class="sig-name descname"><span class="pre">parse_llm_response</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">response</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">expression</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#parse_llm_response" title="Link to this definition">¶</a></dt>
<dd><p>Parses the response from the LLM to extract relevant information based on the context.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>response</strong> (<em>str</em>) – The response string generated by the LLM.</p></li>
<li><p><strong>expression</strong> (<em>str</em><em> or </em><em>None</em>) – The expected type of information to extract from the response. Options include <cite>RETRIEVAL THOUGHT</cite>, <cite>REASONING THOUGHT</cite>, <cite>REASONING</cite>, <cite>ACTION</cite>, or <cite>None</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The extracted information from the response, or <cite>None</cite> if no match is found.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str or None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="get_random_questions_from_metadata">
<span class="sig-name descname"><span class="pre">get_random_questions_from_metadata</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#get_random_questions_from_metadata" title="Link to this definition">¶</a></dt>
<dd><p>Retrieves random follow-up query suggestions from the memory cache.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A string of randomly selected follow-up query suggestions, formatted as a numbered list.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="reset_agent">
<span class="sig-name descname"><span class="pre">__reset_agent</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#reset_agent" title="Link to this definition">¶</a></dt>
<dd><p>Resets the agent’s internal state, including input and step count.</p>
<dl class="simple">
<dt><strong>Description</strong>:</dt><dd><p>This private method reinitializes the agent’s internal state to prepare for a fresh query cycle, clearing any existing data from the previous execution.</p>
</dd>
<dt><strong>Details</strong>:</dt><dd><ul class="simple">
<li><p>Resets step count, answer, and input.</p></li>
<li><p>Clears memory cache and previous queries to ensure no outdated information persists.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="error-handling">
<h2>Error Handling<a class="headerlink" href="#error-handling" title="Link to this heading">¶</a></h2>
<p>The RAGAgent class implements robust error handling for:</p>
<ul class="simple">
<li><p>Query generation failures.</p></li>
<li><p>Retrieval errors due to irrelevant or insufficient data.</p></li>
<li><p>Memory management challenges.</p></li>
</ul>
</section>
<section id="requirements">
<h2>Requirements<a class="headerlink" href="#requirements" title="Link to this heading">¶</a></h2>
<ul class="simple">
<li><p>numpy</p></li>
<li><p>json</p></li>
<li><p>re</p></li>
<li><p>A compatible LLM (e.g., OpenAI GPT) for query generation and retrieval.</p></li>
<li><p>An embedding model capable of calculating query similarity.</p></li>
</ul>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="autoprompt.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Autoprompt</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="utilityquerygenerator.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Utility Query Generator</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; Team 34
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">RAG Agent</a><ul>
<li><a class="reference internal" href="#overview">Overview</a></li>
<li><a class="reference internal" href="#initialization">Initialization</a><ul>
<li><a class="reference internal" href="#RAGAGENT"><code class="docutils literal notranslate"><span class="pre">RAGAGENT</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#methods">Methods</a><ul>
<li><a class="reference internal" href="#check_memory_and_retrieve"><code class="docutils literal notranslate"><span class="pre">check_memory_and_retrieve()</span></code></a></li>
<li><a class="reference internal" href="#check_memory_and_retrieve_for_supervisor"><code class="docutils literal notranslate"><span class="pre">check_memory_and_retrieve_for_supervisor()</span></code></a></li>
<li><a class="reference internal" href="#add_to_memory"><code class="docutils literal notranslate"><span class="pre">add_to_memory()</span></code></a></li>
<li><a class="reference internal" href="#get_existing_graph_queries"><code class="docutils literal notranslate"><span class="pre">get_existing_graph_queries()</span></code></a></li>
<li><a class="reference internal" href="#generate_utility_queries"><code class="docutils literal notranslate"><span class="pre">generate_utility_queries()</span></code></a></li>
<li><a class="reference internal" href="#get_embedding"><code class="docutils literal notranslate"><span class="pre">get_embedding()</span></code></a></li>
<li><a class="reference internal" href="#print_memory_metadata"><code class="docutils literal notranslate"><span class="pre">print_memory_metadata()</span></code></a></li>
<li><a class="reference internal" href="#check_query_in_memory"><code class="docutils literal notranslate"><span class="pre">check_query_in_memory()</span></code></a></li>
<li><a class="reference internal" href="#run"><code class="docutils literal notranslate"><span class="pre">run()</span></code></a></li>
<li><a class="reference internal" href="#step"><code class="docutils literal notranslate"><span class="pre">step()</span></code></a></li>
<li><a class="reference internal" href="#jargon_check"><code class="docutils literal notranslate"><span class="pre">jargon_check()</span></code></a></li>
<li><a class="reference internal" href="#rephrase"><code class="docutils literal notranslate"><span class="pre">rephrase()</span></code></a></li>
<li><a class="reference internal" href="#prompt_thought_agent"><code class="docutils literal notranslate"><span class="pre">prompt_thought_agent()</span></code></a></li>
<li><a class="reference internal" href="#prompt_reasoning_agent"><code class="docutils literal notranslate"><span class="pre">prompt_reasoning_agent()</span></code></a></li>
<li><a class="reference internal" href="#parse_llm_response"><code class="docutils literal notranslate"><span class="pre">parse_llm_response()</span></code></a></li>
<li><a class="reference internal" href="#get_random_questions_from_metadata"><code class="docutils literal notranslate"><span class="pre">get_random_questions_from_metadata()</span></code></a></li>
<li><a class="reference internal" href="#reset_agent"><code class="docutils literal notranslate"><span class="pre">__reset_agent()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#error-handling">Error Handling</a></li>
<li><a class="reference internal" href="#requirements">Requirements</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="../_static/documentation_options.js?v=5929fcd5"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/scripts/furo.js?v=5fa4622c"></script>
    </body>
</html>